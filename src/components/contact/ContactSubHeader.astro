---
import Title from '@components/shared/title/Title.astro';
import { useTranslations } from '@i18n/utils';
import Button from '@components/shared/button/Button.astro';


interface Props {
    data: MD;
    locale?: 'fr' | 'en';
}

const {
    data,
    locale = 'fr',
} = Astro.props;

const {
    title,
} = data.frontmatter;

const Content = data.Content;

const t = useTranslations(locale);


---
<div id="subheader">
    <div class="flex flex-col gap-4 z-10 container pt-[120px]">
        <Title text={title} tag="h1" />
        <div class="subheader cms">
            <Content/>
        </div>
        <form class="flex flex-col gap-4" id="contact-form">
            <div class="flex flex-col sm:flex-row sm:gap-4">
                <div class="flex flex-col flex-1">
                    <label for="firstname" class="text-sm font-medium mb-2">{t('contact.first-name')}</label>
                    <input 
                        type="text" 
                        id="firstname" 
                        name="firstname" 
                        class="border-b border-black py-2 focus:border-primary focus:outline-none" 
                        placeholder="John" 
                        required />
                </div>
                <div class="flex flex-col flex-1">
                    <label for="name" class="text-sm font-medium mb-2">{t('contact.last-name')}</label>
                    <input 
                        type="text" 
                        id="name" 
                        name="name" 
                        class="border-b border-black py-2 focus:border-primary focus:outline-none" 
                        placeholder="Doe" 
                        required />
                </div>
            </div>
            <div class="flex flex-col">
                <label for="mail" class="text-sm font-medium mb-2">{t('contact.email')}</label>
                <input 
                    type="email" 
                    id="mail" 
                    name="mail" 
                    class="border-b border-black py-2 focus:border-primary focus:outline-none" 
                    placeholder="john.doe@example.com" 
                    required />
            </div>
            <div class="flex flex-col">
                <label for="message" class="text-sm font-medium mb-2">{t('contact.message')}</label>
                <textarea 
                    id="message" 
                    name="message" 
                    class="border-b border-black py-2 focus:border-primary focus:outline-none" 
                    placeholder="Lorem ipsum ..." 
                    rows="4" 
                    required></textarea>
            </div>
            <div class="flex items-center justify-end my-4">
                <input 
                    type="checkbox" 
                    id="rgpd" 
                    name="rgpd" 
                    class="mr-2" 
                    required />
                <label for="rgpd" class="text-sm font-medium">{t('contact.rgpd')}</label>
            </div>
            <div class="flex justify-end">
                <Button text={t('contact.send')} type='submit' variant="secondary" />
            </div>

        </form>
    </div>
</div>

<style lang="scss">
    .blog-list {
        &::after{
            content: "";
            flex: auto;
        }
    }
</style>

<script>
    const form = document.getElementById('contact-form');
    const DISPATCHER_ENDPOINT = 'https://contactformjonathanmswfffojx-contact-form.functions.fnc.fr-par.scw.cloud'; // Replace with your actual endpoint

    if (form) {
        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            const formData = new FormData(form as HTMLFormElement);
            const data = Object.fromEntries(formData.entries());
            console.log(data);

            const res = await fetch(DISPATCHER_ENDPOINT, {
                method: "POST",
                body: JSON.stringify(data),
                headers: {
                    "Content-Type": "application/json",
                },
            });

            // Here you can send the data to your server or API
        });
    }
</script>
